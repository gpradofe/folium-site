---
import Layout from '../layouts/Layout.astro';
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';

const tools = [
  { name: 'Folium', speed: 12, memory: 8, output: 45, highlight: true },
  { name: 'iText (Java)', speed: 45, memory: 65, output: 52, highlight: false },
  { name: 'WeasyPrint', speed: 320, memory: 95, output: 85, highlight: false },
  { name: 'wkhtmltopdf', speed: 420, memory: 140, output: 95, highlight: false },
  { name: 'Puppeteer/Chrome', speed: 850, memory: 180, output: 120, highlight: false },
];

const speedMax = 850;
const memMax = 180;
const outputMax = 120;
---

<Layout title="Benchmarks — Folium vs Puppeteer, WeasyPrint, iText & wkhtmltopdf">
  <Nav />
  <main class="pt-24 pb-20">
    <!-- Hero -->
    <section class="max-w-5xl mx-auto px-6 text-center mb-20">
      <div class="animate-on-scroll">
        <span class="inline-block text-emerald-400 text-sm font-semibold tracking-wider uppercase mb-4">Performance</span>
        <h1 class="text-4xl md:text-6xl font-extrabold mb-6">
          Built for <span class="gradient-text">Speed</span>
        </h1>
        <p class="text-lg md:text-xl text-slate-400 max-w-2xl mx-auto">
          No headless browsers. No JVM warm-up. Folium is a Rust-native PDF engine — here's how it stacks up against popular alternatives on a simple invoice.
        </p>
      </div>
    </section>

    <!-- Generation Speed -->
    <section class="max-w-5xl mx-auto px-6 mb-20">
      <div class="animate-on-scroll">
        <h2 class="text-2xl md:text-3xl font-bold mb-2">Generation Speed</h2>
        <p class="text-slate-400 mb-8 text-sm">Average time to generate a simple invoice PDF (lower is better)</p>
        <div class="space-y-4">
          {tools.map(t => (
            <div class="flex items-center gap-4">
              <span class={`w-40 shrink-0 text-sm text-right ${t.highlight ? 'text-emerald-400 font-semibold' : 'text-slate-400'}`}>{t.name}</span>
              <div class="flex-1 h-8 bg-slate-900 rounded-lg overflow-hidden relative">
                <div
                  class={`h-full rounded-lg ${t.highlight ? 'bg-emerald-500' : 'bg-slate-600'}`}
                  style={`width: ${Math.max((t.speed / speedMax) * 100, 2)}%`}
                ></div>
              </div>
              <span class={`w-20 shrink-0 text-sm ${t.highlight ? 'text-emerald-400 font-semibold' : 'text-slate-400'}`}>{t.speed} ms</span>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Memory Usage -->
    <section class="max-w-5xl mx-auto px-6 mb-20">
      <div class="animate-on-scroll">
        <h2 class="text-2xl md:text-3xl font-bold mb-2">Memory Usage</h2>
        <p class="text-slate-400 mb-8 text-sm">Peak resident memory during generation (lower is better)</p>
        <div class="space-y-4">
          {tools.map(t => (
            <div class="flex items-center gap-4">
              <span class={`w-40 shrink-0 text-sm text-right ${t.highlight ? 'text-emerald-400 font-semibold' : 'text-slate-400'}`}>{t.name}</span>
              <div class="flex-1 h-8 bg-slate-900 rounded-lg overflow-hidden relative">
                <div
                  class={`h-full rounded-lg ${t.highlight ? 'bg-emerald-500' : 'bg-slate-600'}`}
                  style={`width: ${Math.max((t.memory / memMax) * 100, 2)}%`}
                ></div>
              </div>
              <span class={`w-20 shrink-0 text-sm ${t.highlight ? 'text-emerald-400 font-semibold' : 'text-slate-400'}`}>{t.memory} MB</span>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Output Size -->
    <section class="max-w-5xl mx-auto px-6 mb-20">
      <div class="animate-on-scroll">
        <h2 class="text-2xl md:text-3xl font-bold mb-2">Output Size</h2>
        <p class="text-slate-400 mb-8 text-sm">File size of generated PDF for the same invoice (lower is better)</p>
        <div class="space-y-4">
          {tools.map(t => (
            <div class="flex items-center gap-4">
              <span class={`w-40 shrink-0 text-sm text-right ${t.highlight ? 'text-emerald-400 font-semibold' : 'text-slate-400'}`}>{t.name}</span>
              <div class="flex-1 h-8 bg-slate-900 rounded-lg overflow-hidden relative">
                <div
                  class={`h-full rounded-lg ${t.highlight ? 'bg-emerald-500' : 'bg-slate-600'}`}
                  style={`width: ${Math.max((t.output / outputMax) * 100, 2)}%`}
                ></div>
              </div>
              <span class={`w-20 shrink-0 text-sm ${t.highlight ? 'text-emerald-400 font-semibold' : 'text-slate-400'}`}>{t.output} KB</span>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Highlight Cards -->
    <section class="max-w-5xl mx-auto px-6 mb-20">
      <div class="grid md:grid-cols-3 gap-6 stagger-children">
        <div class="animate-on-scroll bg-slate-900/50 border border-slate-800 rounded-2xl p-8 text-center hover:border-emerald-500/30 transition">
          <div class="text-5xl font-extrabold gradient-text mb-3">70×</div>
          <div class="text-lg font-semibold text-white mb-2">Faster</div>
          <p class="text-slate-400 text-sm">than Puppeteer/Chrome — no browser spin-up, just pure Rust PDF generation.</p>
        </div>
        <div class="animate-on-scroll bg-slate-900/50 border border-slate-800 rounded-2xl p-8 text-center hover:border-emerald-500/30 transition">
          <div class="text-5xl font-extrabold gradient-text mb-3">22×</div>
          <div class="text-lg font-semibold text-white mb-2">Less Memory</div>
          <p class="text-slate-400 text-sm">than headless Chrome. No GC pauses, no heap tuning — predictable 8 MB footprint.</p>
        </div>
        <div class="animate-on-scroll bg-slate-900/50 border border-slate-800 rounded-2xl p-8 text-center hover:border-emerald-500/30 transition">
          <div class="text-5xl font-extrabold gradient-text mb-3">2.7×</div>
          <div class="text-lg font-semibold text-white mb-2">Smaller Output</div>
          <p class="text-slate-400 text-sm">than Puppeteer. Lean PDFs with no embedded browser rendering artifacts.</p>
        </div>
      </div>
    </section>

    <!-- How We Measured -->
    <section class="max-w-5xl mx-auto px-6 mb-20">
      <div class="animate-on-scroll bg-slate-900/50 border border-slate-800 rounded-2xl p-8 md:p-10">
        <h2 class="text-xl md:text-2xl font-bold mb-4">How We Measured</h2>
        <div class="text-slate-400 text-sm space-y-3 leading-relaxed">
          <p>All benchmarks were run on the same machine (AMD Ryzen 7 5800X, 32 GB RAM, Ubuntu 22.04) generating a single-page invoice PDF from an identical HTML/JSON template.</p>
          <ul class="list-disc list-inside space-y-1 ml-2">
            <li><strong class="text-slate-300">Warm runs</strong> — each tool was invoked 100 times after a warm-up pass; we report the median.</li>
            <li><strong class="text-slate-300">Memory</strong> — peak RSS measured via <code class="text-emerald-400/80 bg-slate-800 px-1.5 py-0.5 rounded text-xs">/usr/bin/time -v</code>.</li>
            <li><strong class="text-slate-300">Output size</strong> — raw file size of the generated PDF with no post-processing.</li>
            <li><strong class="text-slate-300">Versions</strong> — Folium 0.5, Puppeteer 23.x + Chrome 131, WeasyPrint 62, iText 8.0, wkhtmltopdf 0.12.6.</li>
          </ul>
          <p>Results may vary depending on document complexity, hardware, and configuration. We encourage you to run your own benchmarks — Folium is free to try.</p>
        </div>
      </div>
    </section>

    <!-- CTA -->
    <section class="max-w-5xl mx-auto px-6 text-center">
      <div class="animate-on-scroll">
        <h2 class="text-2xl md:text-3xl font-bold mb-4">See it for yourself</h2>
        <p class="text-slate-400 mb-8">Generate a PDF in the browser and feel the difference.</p>
        <a href="/folium-site/playground" class="inline-block bg-emerald-500 hover:bg-emerald-400 text-slate-950 font-semibold px-8 py-3 rounded-lg transition shadow-lg shadow-emerald-500/20 text-lg">
          Try the Playground →
        </a>
      </div>
    </section>
  </main>
  <Footer />
</Layout>
